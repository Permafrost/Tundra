<?xml version="1.0" encoding="UTF-8"?>

<Values version="2.0">
  <value name="node_type">interface</value>
  <value name="node_nsName">tundra.document</value>
  <value name="encodeutf8">true</value>
  <value name="shared">Ly8gcmV0dXJucyB3aGV0aGVyIHR3byBkb2N1bWVudHMgYXJlIGVxdWFsCnB1YmxpYyBzdGF0aWMg
Ym9vbGVhbiBlcXVhbChJRGF0YSB4LCBJRGF0YSB5KSB7CiAgcmV0dXJuIHR1bmRyYS5vYmplY3Qu
ZXF1YWwoeCwgeSk7Cn0KCi8vIHJldHVybnMgYWxsIHRoZSBrZXlzIGluIHRoZSBnaXZlbiBkb2N1
bWVudCBhcyBhIHN0cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgU3RyaW5nW10ga2V5c2V0KElEYXRh
IGlucHV0KSB7CiAgamF2YS51dGlsLkxpc3Q8U3RyaW5nPiBrZXlzID0gbmV3IGphdmEudXRpbC5B
cnJheUxpc3Q8U3RyaW5nPigpOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNv
ciBjdXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHdoaWxlKGN1cnNvci5uZXh0KCkpIHsK
ICAgICAga2V5cy5hZGQoY3Vyc29yLmdldEtleSgpKTsKICAgIH0KICAgIGN1cnNvci5kZXN0cm95
KCk7CiAgfQogIHJldHVybiAoU3RyaW5nW10pa2V5cy50b0FycmF5KG5ldyBTdHJpbmdbMF0pOwp9
CgovLyByZXR1cm5zIGFsbCB0aGUgdmFsdWVzIGluIHRoZSBnaXZlbiBkb2N1bWVudCBhcyBhIHN0
cmluZyBsaXN0CnB1YmxpYyBzdGF0aWMgT2JqZWN0W10gdmFsdWVzZXQoSURhdGEgaW5wdXQpIHsK
ICBqYXZhLnV0aWwuTGlzdDxPYmplY3Q+IHZhbHVlcyA9IG5ldyBqYXZhLnV0aWwuQXJyYXlMaXN0
PE9iamVjdD4oKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgSURhdGFDdXJzb3IgY3Vyc29y
ID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgICB3aGlsZShjdXJzb3IubmV4dCgpKSB7CiAgICAgIHZh
bHVlcy5hZGQoY3Vyc29yLmdldFZhbHVlKCkpOwogICAgfQogICAgY3Vyc29yLmRlc3Ryb3koKTsK
ICB9CiAgcmV0dXJuIChPYmplY3RbXSl2YWx1ZXMudG9BcnJheShuZXcgT2JqZWN0WzBdKTsKfQoK
Ly8gbWVyZ2VzIG11bHRpcGxlIElEYXRhIGRvY3VtZW50cyBpbnRvIGEgc2luZ2xlIGRvY3VtZW50
CnB1YmxpYyBzdGF0aWMgSURhdGEgbWVyZ2UoSURhdGFbXSBpbnB1dCkgewogIElEYXRhIG91dHB1
dCA9IElEYXRhRmFjdG9yeS5jcmVhdGUoKTsKICBpZiAoaW5wdXQgIT0gbnVsbCkgewogICAgZm9y
IChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykgewogICAgICBJRGF0YVV0aWwubWVy
Z2UoaW5wdXRbaV0sIG91dHB1dCk7CiAgICB9CiAgfQogIHJldHVybiBvdXRwdXQ7Cn0KCi8vIHJl
dHVybnMgdGhlIG51bWJlciBvZiB0b3AtbGV2ZWwge2tleSwgdmFsdWV9IHBhaXJzIGluIHRoZSBn
aXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIGludCBzaXplKElEYXRhIGlucHV0KSB7
CiAgaW50IHNpemUgPSAwOwogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBj
dXJzb3IgPSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHNpemUgPSBJRGF0YVV0aWwuc2l6ZShjdXJz
b3IpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIHNpemU7Cn0KCi8vIHJldHVy
bnMgYSBjbG9uZSBvZiB0aGUgZ2l2ZW4gSURhdGEgZG9jdW1lbnQKcHVibGljIHN0YXRpYyBJRGF0
YSBkdXBsaWNhdGUoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgdGhyb3dzIFNlcnZpY2VF
eGNlcHRpb24gewogIElEYXRhIG91dHB1dCA9IG51bGw7CiAgaWYgKGlucHV0ICE9IG51bGwpIHsK
ICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1cnNvcigpOwogICAgdHJ5IHsKICAg
ICAgaWYgKHJlY3Vyc2UpIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuZGVlcENsb25lKGlu
cHV0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvdXRwdXQgPSBJRGF0YVV0aWwuY2xvbmUoaW5w
dXQpOwogICAgICB9CiAgICB9IGNhdGNoIChqYXZhLmlvLklPRXhjZXB0aW9uIGV4KSB7CiAgICAg
IHR1bmRyYS5leGNlcHRpb24ucmFpc2UoZXgpOwogICAgfSBmaW5hbGx5IHsKICAgICAgY3Vyc29y
LmRlc3Ryb3koKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmVtb3ZlcyB0aGUg
dmFsdWUgd2l0aCB0aGUgZ2l2ZW4ga2V5IGZyb20gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1
YmxpYyBzdGF0aWMgSURhdGEgZHJvcChJRGF0YSBpbnB1dCwgU3RyaW5nIGtleSkgewogIGlmIChp
bnB1dCAhPSBudWxsICYmIGtleSAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3IgPSBp
bnB1dC5nZXRDdXJzb3IoKTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXkpOwogICAg
Y3Vyc29yLmRlc3Ryb3koKTsKCiAgICBpZiAodHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQuS2V5Lmlz
RnVsbHlRdWFsaWZpZWQoa2V5KSkgZHJvcChpbnB1dCwgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQu
S2V5LnBhcnNlKGtleSkpOwogIH0KICByZXR1cm4gaW5wdXQ7Cn0KCi8vIHJlbW92ZXMgdGhlIHZh
bHVlIHdpdGggdGhlIGdpdmVuIGtleSBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwcm90
ZWN0ZWQgc3RhdGljIElEYXRhIGRyb3AoSURhdGEgaW5wdXQsIGphdmEudXRpbC5RdWV1ZTx0dW5k
cmEuc3VwcG9ydC5kb2N1bWVudC5LZXk+IGtleXMpIHsKICBpZiAoaW5wdXQgIT0gbnVsbCAmJiBr
ZXlzICE9IG51bGwgJiYga2V5cy5zaXplKCkgPiAwKSB7CiAgICBJRGF0YUN1cnNvciBjdXJzb3Ig
PSBpbnB1dC5nZXRDdXJzb3IoKTsKICAgIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LktleSBrZXkg
PSBrZXlzLnJlbW92ZSgpOwoKICAgIGlmIChrZXlzLnNpemUoKSA+IDApIHsKICAgICAgaWYgKGtl
eS5oYXNJbmRleCgpKSB7CiAgICAgICAgSURhdGFbXSBhcnJheSA9IElEYXRhVXRpbC5nZXRJRGF0
YUFycmF5KGN1cnNvciwga2V5LnRvU3RyaW5nKCkpOwogICAgICAgIGRyb3AodHVuZHJhLmxpc3Qu
b2JqZWN0LmdldChhcnJheSwga2V5LmdldEluZGV4KCkpLCBrZXlzKTsKICAgICAgfSBlbHNlIHsK
ICAgICAgICBkcm9wKElEYXRhVXRpbC5nZXRJRGF0YShjdXJzb3IsIGtleS50b1N0cmluZygpKSwg
a2V5cyk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChrZXkuaGFzSW5kZXgoKSkgewog
ICAgICAgIE9iamVjdFtdIGFycmF5ID0gSURhdGFVdGlsLmdldE9iamVjdEFycmF5KGN1cnNvciwg
a2V5LnRvU3RyaW5nKCkpOwogICAgICAgIElEYXRhVXRpbC5wdXQoY3Vyc29yLCBrZXkudG9TdHJp
bmcoKSwgdHVuZHJhLmxpc3Qub2JqZWN0LmRyb3AoYXJyYXksIGtleS5nZXRJbmRleCgpKSk7CiAg
ICAgIH0gZWxzZSB7CiAgICAgICAgSURhdGFVdGlsLnJlbW92ZShjdXJzb3IsIGtleS50b1N0cmlu
ZygpKTsKICAgICAgfQogICAgfQogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9CiAgcmV0dXJuIGlu
cHV0Owp9CgovLyB2aXNpdHMgZWFjaCBlbGVtZW50IGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVu
dCwgY2FsbHMgdGhlIGdpdmVuIHNlcnZpY2UgdG8gY29udmVydCB0aGUgZWxlbWVudCwgYW5kIGNy
ZWF0ZXMgYSBuZXcgSURhdGEgZG9jdW1lbnQgd2l0aCB0aGUgcmVzdWx0aW5nIGVsZW1lbnRzCnB1
YmxpYyBzdGF0aWMgSURhdGEgbWFwKElEYXRhIGlucHV0LCBTdHJpbmcgc2VydmljZSwgSURhdGEg
cGlwZWxpbmUsIFN0cmluZyBrZXlJbnB1dCwgU3RyaW5nIGtleU91dHB1dCwgU3RyaW5nIHZhbHVl
SW5wdXQsIFN0cmluZyB2YWx1ZU91dHB1dCwgQ2xhc3MgdmFsdWVDbGFzcywgYm9vbGVhbiByZWN1
cnNlKSB0aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgSURhdGEgb3V0cHV0ID0gbnVsbDsKCiAg
aWYgKGlucHV0ICE9IG51bGwgJiYgc2VydmljZSAhPSBudWxsKSB7CiAgICBJRGF0YUN1cnNvciBp
YyA9IGlucHV0LmdldEN1cnNvcigpOwogICAgb3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgp
OwogICAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogICAgaWYgKGtleUlu
cHV0ID09IG51bGwpIGtleUlucHV0ID0gIiRrZXkiOwogICAgaWYgKGtleU91dHB1dCA9PSBudWxs
KSBrZXlPdXRwdXQgPSBrZXlJbnB1dDsKICAgIGlmICh2YWx1ZUlucHV0ID09IG51bGwpIHZhbHVl
SW5wdXQgPSAiJHZhbHVlIjsKICAgIGlmICh2YWx1ZU91dHB1dCA9PSBudWxsKSB2YWx1ZU91dHB1
dCA9IHZhbHVlSW5wdXQ7CiAgICBpZiAocGlwZWxpbmUgPT0gbnVsbCkgcGlwZWxpbmUgPSBJRGF0
YUZhY3RvcnkuY3JlYXRlKCk7CgogICAgdHJ5IHsKICAgICAgd2hpbGUoaWMubmV4dCgpKSB7CiAg
ICAgICAgVHVwbGU8T2JqZWN0PiB0dXBsZSA9IG5ldyBUdXBsZTxPYmplY3Q+KGljLmdldEtleSgp
LCBpYy5nZXRWYWx1ZSgpKTsKCiAgICAgICAgaWYgKHJlY3Vyc2UgJiYgdHVwbGUudmFsdWUgIT0g
bnVsbCkgewogICAgICAgICAgaWYgKHR1cGxlLnZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAg
ICAgICAgICAgdHVwbGUudmFsdWUgPSBtYXAoKElEYXRhKXR1cGxlLnZhbHVlLCBzZXJ2aWNlLCBw
aXBlbGluZSwga2V5SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZh
bHVlQ2xhc3MsIHJlY3Vyc2UpOwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0
YW5jZW9mIElEYXRhW10gfHwgdHVwbGUudmFsdWUgaW5zdGFuY2VvZiBjb20ud20udXRpbC5UYWJs
ZSkgewogICAgICAgICAgICBJRGF0YVtdIGlhcnkgPSB0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIElE
YXRhW10gPyAoSURhdGFbXSl0dXBsZS52YWx1ZSA6ICgoY29tLndtLnV0aWwuVGFibGUpdHVwbGUu
dmFsdWUpLmdldFZhbHVlcygpOwogICAgICAgICAgICBJRGF0YVtdIG9hcnkgPSBuZXcgSURhdGFb
aWFyeS5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3Ro
OyBpKyspIHsKICAgICAgICAgICAgICBvYXJ5W2ldID0gbWFwKGlhcnlbaV0sIHNlcnZpY2UsIHBp
cGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1ZU91dHB1dCwgdmFs
dWVDbGFzcywgcmVjdXJzZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHVwbGUudmFsdWUg
PSBvYXJ5OwogICAgICAgICAgfSBlbHNlIGlmICh0dXBsZS52YWx1ZSBpbnN0YW5jZW9mIFN0cmlu
Z1tdW10pIHsKICAgICAgICAgICAgU3RyaW5nW11bXSBpYXJ5ID0gKFN0cmluZ1tdW10pdHVwbGUu
dmFsdWU7CiAgICAgICAgICAgIFN0cmluZ1tdW10gb2FyeSA9IG5ldyBTdHJpbmdbaWFyeS5sZW5n
dGhdW107CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkrKykg
ewogICAgICAgICAgICAgIGlmIChpYXJ5W2ldICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG9h
cnlbaV0gPSBuZXcgU3RyaW5nW2lhcnlbaV0ubGVuZ3RoXTsKICAgICAgICAgICAgICAgIGZvciAo
aW50IGogPSAwOyBqIDwgaWFyeVtpXS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICBU
dXBsZTxTdHJpbmc+IHQgPSBtYXAobmV3IFR1cGxlPFN0cmluZz4odHVwbGUua2V5LCBpYXJ5W2ld
W2pdKSwgc2VydmljZSwgcGlwZWxpbmUsIGtleUlucHV0LCBrZXlPdXRwdXQsIHZhbHVlSW5wdXQs
IHZhbHVlT3V0cHV0LCB2YWx1ZUNsYXNzKTsKICAgICAgICAgICAgICAgICAgb2FyeVtpXVtqXSA9
IHQudmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9
CiAgICAgICAgICAgIHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVw
bGUudmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAgICAgICBTdHJpbmdbXSBpYXJ5
ID0gKFN0cmluZ1tdKXR1cGxlLnZhbHVlOwogICAgICAgICAgICBTdHJpbmdbXSBvYXJ5ID0gbmV3
IFN0cmluZ1tpYXJ5Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFy
eS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgIFR1cGxlPFN0cmluZz4gdCA9IG1hcChuZXcg
VHVwbGU8U3RyaW5nPih0dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5
SW5wdXQsIGtleU91dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwog
ICAgICAgICAgICAgIG9hcnlbaV0gPSB0LnZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAg
IHR1cGxlLnZhbHVlID0gb2FyeTsKICAgICAgICAgIH0gZWxzZSBpZiAodHVwbGUudmFsdWUgaW5z
dGFuY2VvZiBPYmplY3RbXSkgewogICAgICAgICAgICBPYmplY3RbXSBpYXJ5ID0gKE9iamVjdFtd
KXR1cGxlLnZhbHVlOwogICAgICAgICAgICBPYmplY3RbXSBvYXJ5ID0gbmV3IE9iamVjdFtpYXJ5
Lmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaWFyeS5sZW5ndGg7IGkr
KykgewogICAgICAgICAgICAgIFR1cGxlPE9iamVjdD4gdCA9IG1hcChuZXcgVHVwbGU8T2JqZWN0
Pih0dXBsZS5rZXksIGlhcnlbaV0pLCBzZXJ2aWNlLCBwaXBlbGluZSwga2V5SW5wdXQsIGtleU91
dHB1dCwgdmFsdWVJbnB1dCwgdmFsdWVPdXRwdXQsIHZhbHVlQ2xhc3MpOwogICAgICAgICAgICAg
IG9hcnlbaV0gPSB0LnZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHR1cGxlLnZhbHVl
ID0gb2FyeTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdHVwbGUgPSBtYXAodHVwbGUs
IHNlcnZpY2UsIHBpcGVsaW5lLCBrZXlJbnB1dCwga2V5T3V0cHV0LCB2YWx1ZUlucHV0LCB2YWx1
ZU91dHB1dCwgdmFsdWVDbGFzcyk7CiAgICAgICAgSURhdGFVdGlsLnB1dChvYywgdHVwbGUua2V5
LCB0dXBsZS52YWx1ZSk7CiAgICAgIH0KICAgIH0gZmluYWxseSB7CiAgICAgIGljLmRlc3Ryb3ko
KTsKICAgICAgb2MuZGVzdHJveSgpOwogICAgfQogIH0gZWxzZSB7CiAgICBvdXRwdXQgPSBkdXBs
aWNhdGUoaW5wdXQsIHJlY3Vyc2UpOwogIH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gd3JhcHBl
ciBjbGFzcyBmb3Ige2tleSwgdmFsdWV9IHR1cGxlcwpwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIFR1
cGxlPFQ+IHsgCiAgcHVibGljIFN0cmluZyBrZXk7CiAgcHVibGljIFQgdmFsdWU7CiAgcHVibGlj
IFR1cGxlKFN0cmluZyBrZXksIFQgdmFsdWUpIHsgCiAgICB0aGlzLmtleSA9IGtleTsgCiAgICB0
aGlzLnZhbHVlID0gdmFsdWU7IAogIH0KfQoKLy8gY29udmVydHMgdGhlIGdpdmVuIGVsZW1lbnQg
YnkgY2FsbGluZyB0aGUgZ2l2ZW4gc2VydmljZSwgYW5kIHJldHVybnMgdGhlIHJlc3VsdApwcm90
ZWN0ZWQgc3RhdGljIDxUPiBUdXBsZTxUPiBtYXAoVHVwbGU8VD4gdHVwbGUsIFN0cmluZyBzZXJ2
aWNlLCBJRGF0YSBwaXBlbGluZSwgU3RyaW5nIGtleUlucHV0LCBTdHJpbmcga2V5T3V0cHV0LCBT
dHJpbmcgdmFsdWVJbnB1dCwgU3RyaW5nIHZhbHVlT3V0cHV0LCBDbGFzcyB2YWx1ZUNsYXNzKSB0
aHJvd3MgU2VydmljZUV4Y2VwdGlvbiB7CiAgaWYgKHR1cGxlLnZhbHVlID09IG51bGwgfHwgdmFs
dWVDbGFzcyA9PSBudWxsIHx8IHZhbHVlQ2xhc3MuaXNJbnN0YW5jZSh0dXBsZS52YWx1ZSkpIHsK
ICAgIElEYXRhQ3Vyc29yIGN1cnNvciA9IHBpcGVsaW5lLmdldEN1cnNvcigpOwogICAgSURhdGFV
dGlsLnB1dChjdXJzb3IsIGtleUlucHV0LCB0dXBsZS5rZXkpOwogICAgSURhdGFVdGlsLnB1dChj
dXJzb3IsIHZhbHVlSW5wdXQsIHR1cGxlLnZhbHVlKTsKICAgIGN1cnNvci5kZXN0cm95KCk7Cgog
ICAgcGlwZWxpbmUgPSB0dW5kcmEuc2VydmljZS5pbnZva2Uoc2VydmljZSwgcGlwZWxpbmUpOwoK
ICAgIC8vIGNsZWFuIHVwIHRoZSBpbnB1dCBwaXBlbGluZQogICAgY3Vyc29yID0gcGlwZWxpbmUu
Z2V0Q3Vyc29yKCk7CiAgICB0dXBsZS5rZXkgPSBJRGF0YVV0aWwuZ2V0U3RyaW5nKGN1cnNvciwg
a2V5T3V0cHV0KTsKICAgIHR1cGxlLnZhbHVlID0gKFQpSURhdGFVdGlsLmdldChjdXJzb3IsIHZh
bHVlT3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCBrZXlJbnB1dCk7CiAgICBp
ZiAoIWtleUlucHV0LmVxdWFscyhrZXlPdXRwdXQpKSBJRGF0YVV0aWwucmVtb3ZlKGN1cnNvciwg
a2V5T3V0cHV0KTsKICAgIElEYXRhVXRpbC5yZW1vdmUoY3Vyc29yLCB2YWx1ZUlucHV0KTsKICAg
IGlmICghdmFsdWVJbnB1dC5lcXVhbHModmFsdWVPdXRwdXQpKSBJRGF0YVV0aWwucmVtb3ZlKGN1
cnNvciwgdmFsdWVPdXRwdXQpOwogICAgY3Vyc29yLmRlc3Ryb3koKTsKICB9ICAKICByZXR1cm4g
dHVwbGU7Cn0KCi8vIGludm9rZXMgdGhlIGdpdmVuIHNlcnZpY2UgZm9yIGVhY2gge2tleSwgdmFs
dWV9IHBhaXIgaW4gdGhlIGdpdmVuIElEYXRhIGRvY3VtZW50CnB1YmxpYyBzdGF0aWMgdm9pZCBl
YWNoKElEYXRhIGlucHV0LCBTdHJpbmcgc2VydmljZSwgSURhdGEgcGlwZWxpbmUsIFN0cmluZyBr
ZXlJbnB1dCwgU3RyaW5nIHZhbHVlSW5wdXQsIENsYXNzIHZhbHVlQ2xhc3MsIGJvb2xlYW4gcmVj
dXJzZSkgdGhyb3dzIFNlcnZpY2VFeGNlcHRpb24gewogIG1hcChpbnB1dCwgc2VydmljZSwgcGlw
ZWxpbmUsIGtleUlucHV0LCBudWxsLCB2YWx1ZUlucHV0LCBudWxsLCB2YWx1ZUNsYXNzLCByZWN1
cnNlKTsKfQoKLy8gcmVuYW1lcyBhIGtleSBmcm9tIHNvdXJjZSB0byB0YXJnZXQgd2l0aGluIHRo
ZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIElEYXRhIHJlbmFtZShJRGF0YSBp
bnB1dCwgU3RyaW5nIHNvdXJjZSwgU3RyaW5nIHRhcmdldCkgewogIHJldHVybiBkcm9wKGNvcHko
aW5wdXQsIHNvdXJjZSwgdGFyZ2V0KSwgc291cmNlKTsKfQoKLy8gY29waWVzIGEgdmFsdWUgZnJv
bSBzb3VyY2Uga2V5IHRvIHRhcmdldCBrZXkgd2l0aGluIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVu
dApwdWJsaWMgc3RhdGljIElEYXRhIGNvcHkoSURhdGEgaW5wdXQsIFN0cmluZyBzb3VyY2UsIFN0
cmluZyB0YXJnZXQpIHsKICBpZiAoc291cmNlLmVxdWFscyh0YXJnZXQpKSByZXR1cm4gaW5wdXQ7
CiAgcmV0dXJuIHR1bmRyYS5zdXBwb3J0LmRvY3VtZW50LnB1dChpbnB1dCwgdGFyZ2V0LCB0dW5k
cmEuc3VwcG9ydC5kb2N1bWVudC5nZXQoaW5wdXQsIHNvdXJjZSkpOwp9CgovLyByZW1vdmVzIGFs
bCBudWxsIHZhbHVlcyBmcm9tIHRoZSBnaXZlbiBJRGF0YSBkb2N1bWVudApwdWJsaWMgc3RhdGlj
IElEYXRhIGNvbXBhY3QoSURhdGEgaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIElEYXRhIG91
dHB1dCA9IG51bGw7CgogIGlmIChpbnB1dCAhPSBudWxsKSB7CiAgICBvdXRwdXQgPSBJRGF0YUZh
Y3RvcnkuY3JlYXRlKCk7CiAgICBJRGF0YUN1cnNvciBpYyA9IGlucHV0LmdldEN1cnNvcigpOwog
ICAgSURhdGFDdXJzb3Igb2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogICAgdHJ5IHsKICAgICAg
d2hpbGUoaWMubmV4dCgpKSB7CiAgICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAg
ICAgIE9iamVjdCB2YWx1ZSA9IGljLmdldFZhbHVlKCk7CgogICAgICAgIGlmICh2YWx1ZSAhPSBu
dWxsKSB7CiAgICAgICAgICBpZiAocmVjdXJzZSkgewogICAgICAgICAgICBpZiAodmFsdWUgaW5z
dGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgICAgIHZhbHVlID0gY29tcGFjdCgoSURhdGEpdmFs
dWUsIHJlY3Vyc2UpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURh
dGFbXSkgewogICAgICAgICAgICAgIElEYXRhW10gYXJyYXkgPSB0dW5kcmEubGlzdC5vYmplY3Qu
Y29tcGFjdCgoSURhdGFbXSl2YWx1ZSk7CiAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg
PCBhcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYXJyYXlbaV0gPSBjb21wYWN0
KGFycmF5W2ldLCByZWN1cnNlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdmFsdWUg
PSBhcnJheTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1td
W10pIHsKICAgICAgICAgICAgICBTdHJpbmdbXVtdIGFycmF5ID0gKFN0cmluZ1tdW10pdmFsdWU7
CiAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykgewog
ICAgICAgICAgICAgICAgYXJyYXlbaV0gPSB0dW5kcmEubGlzdC5vYmplY3QuY29tcGFjdChhcnJh
eVtpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhbHVlID0gYXJyYXk7CiAgICAg
ICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdbXSkgewogICAgICAgICAg
ICAgIHZhbHVlID0gdHVuZHJhLmxpc3Qub2JqZWN0LmNvbXBhY3QoKFN0cmluZ1tdKXZhbHVlKTsK
ICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFtdKSB7CiAgICAg
ICAgICAgICAgdmFsdWUgPSB0dW5kcmEubGlzdC5vYmplY3QuY29tcGFjdCgoT2JqZWN0W10pdmFs
dWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodmFs
dWUgIT0gbnVsbCkgSURhdGFVdGlsLnB1dChvYywga2V5LCB2YWx1ZSk7CiAgICAgIH0KICAgIH0g
ZmluYWxseSB7CiAgICAgIGljLmRlc3Ryb3koKTsKICAgICAgb2MuZGVzdHJveSgpOwogICAgfQog
IH0KCiAgcmV0dXJuIG91dHB1dDsKfQoKLy8gcmV0dXJucyBhIG5ldyBJRGF0YSBkb2N1bWVudCwg
d2hlcmUgYWxsIElEYXRhcyBhcmUgaW1wbGVtZW50ZWQgd2l0aCB0aGUgc2FtZSBjbGFzcywgYW5k
IGFsbAovLyBmdWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVwbGFjZWQgd2l0aCBhIG5lc3RlZCBz
dHJ1Y3R1cmUKcHVibGljIHN0YXRpYyBJRGF0YSBub3JtYWxpemUoSURhdGEgaW5wdXQsIGJvb2xl
YW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxsKSByZXR1cm4gbnVsbDsKCiAgSURhdGEg
b3V0cHV0ID0gSURhdGFGYWN0b3J5LmNyZWF0ZSgpOwogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQu
Z2V0Q3Vyc29yKCk7CgogIHRyeSB7CiAgICB3aGlsZShpYy5uZXh0KCkpIHsKICAgICAgU3RyaW5n
IGtleSA9IGljLmdldEtleSgpOwogICAgICBPYmplY3QgdmFsdWUgPSBpYy5nZXRWYWx1ZSgpOwoK
ICAgICAgaWYgKHZhbHVlICE9IG51bGwpIHsKICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBj
b20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGUpIHsKICAgICAgICAgIHZhbHVlID0gKChjb20u
d20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGUpdmFsdWUpLmdldElEYXRhKCk7CiAgICAgICAgfSBl
bHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLlZhbHVlc0NvZGFibGUp
IHsKICAgICAgICAgIHZhbHVlID0gKChjb20ud20udXRpbC5jb2Rlci5WYWx1ZXNDb2RhYmxlKXZh
bHVlKS5nZXRWYWx1ZXMoKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgY29t
LndtLnV0aWwuY29kZXIuSURhdGFDb2RhYmxlW10pIHsKICAgICAgICAgIHZhbHVlID0gbm9ybWFs
aXplKChjb20ud20udXRpbC5jb2Rlci5JRGF0YUNvZGFibGVbXSl2YWx1ZSwgcmVjdXJzZSk7CiAg
ICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGNvbS53bS51dGlsLmNvZGVyLlZhbHVl
c0NvZGFibGVbXSkgewogICAgICAgICAgdmFsdWUgPSBub3JtYWxpemUoKGNvbS53bS51dGlsLmNv
ZGVyLlZhbHVlc0NvZGFibGVbXSl2YWx1ZSwgcmVjdXJzZSk7CiAgICAgICAgfSBlbHNlIGlmICh2
YWx1ZSBpbnN0YW5jZW9mIElEYXRhW10pIHsKICAgICAgICAgIHZhbHVlID0gbm9ybWFsaXplKChJ
RGF0YVtdKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNl
b2YgY29tLndtLnV0aWwuVGFibGUpIHsKICAgICAgICAgIHZhbHVlID0gbm9ybWFsaXplKCgoY29t
LndtLnV0aWwuVGFibGUpdmFsdWUpLmdldFZhbHVlcygpLCByZWN1cnNlKTsKICAgICAgICB9IGVs
c2UgaWYgKHJlY3Vyc2UgJiYgdmFsdWUgaW5zdGFuY2VvZiBJRGF0YSkgewogICAgICAgICAgdmFs
dWUgPSBub3JtYWxpemUoKElEYXRhKXZhbHVlLCByZWN1cnNlKTsKICAgICAgICB9CiAgICAgIH0K
ICAgICAgdHVuZHJhLnN1cHBvcnQuZG9jdW1lbnQucHV0KG91dHB1dCwga2V5LCB2YWx1ZSk7CiAg
ICB9CiAgfSBmaW5hbGx5IHsKICAgIGljLmRlc3Ryb3koKTsKICB9CgogIHJldHVybiBvdXRwdXQ7
Cn0KCi8vIG5vcm1hbGl6ZXMgYW4gSURhdGFbXSwgd2hlcmUgYWxsIElEYXRhcyBhcmUgaW1wbGVt
ZW50ZWQgd2l0aCB0aGUgc2FtZSBjbGFzcywgYW5kIGFsbAovLyBmdWxseSBxdWFsaWZpZWQga2V5
cyBhcmUgcmVwbGFjZWQgd2l0aCBhIG5lc3RlZCBzdHJ1Y3R1cmUKcHJvdGVjdGVkIHN0YXRpYyBJ
RGF0YVtdIG5vcm1hbGl6ZShJRGF0YVtdIGlucHV0LCBib29sZWFuIHJlY3Vyc2UpIHsKICBpZiAo
aW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhW10gb3V0cHV0ID0gbmV3IElEYXRh
W2lucHV0Lmxlbmd0aF07CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkrKykg
ewogICAgb3V0cHV0W2ldID0gbm9ybWFsaXplKGlucHV0W2ldLCByZWN1cnNlKTsKICB9CgogIHJl
dHVybiBvdXRwdXQ7Cn0KCi8vIGNvbnZlcnRzIGFuIElEYXRhQ29kYWJsZVtdIHRvIGFuIElEYXRh
W10gYW5kIG5vcm1hbGl6ZXMsIHdoZXJlIGFsbCBJRGF0YXMgYXJlIGltcGxlbWVudGVkIAovLyB3
aXRoIHRoZSBzYW1lIGNsYXNzLCBhbmQgYWxsIGZ1bGx5IHF1YWxpZmllZCBrZXlzIGFyZSByZXBs
YWNlZCB3aXRoIGEgbmVzdGVkIHN0cnVjdHVyZQpwcm90ZWN0ZWQgc3RhdGljIElEYXRhW10gbm9y
bWFsaXplKGNvbS53bS51dGlsLmNvZGVyLklEYXRhQ29kYWJsZVtdIGlucHV0LCBib29sZWFuIHJl
Y3Vyc2UpIHsKICBpZiAoaW5wdXQgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogIElEYXRhW10gb3V0
cHV0ID0gbmV3IElEYXRhW2lucHV0Lmxlbmd0aF07CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnB1
dC5sZW5ndGg7IGkrKykgewogICAgb3V0cHV0W2ldID0gbm9ybWFsaXplKGlucHV0W2ldLmdldElE
YXRhKCksIHJlY3Vyc2UpOwogIH0KICAKICByZXR1cm4gb3V0cHV0Owp9CgovLyBjb252ZXJ0cyBh
IFZhbHVlc0NvZGFibGVbXSB0byBhbiBJRGF0YVtdIGFuZCBub3JtYWxpemVzLCB3aGVyZSBhbGwg
SURhdGFzIGFyZSBpbXBsZW1lbnRlZCAKLy8gd2l0aCB0aGUgc2FtZSBjbGFzcywgYW5kIGFsbCBm
dWxseSBxdWFsaWZpZWQga2V5cyBhcmUgcmVwbGFjZWQgd2l0aCBhIG5lc3RlZCBzdHJ1Y3R1cmUK
cHJvdGVjdGVkIHN0YXRpYyBJRGF0YVtdIG5vcm1hbGl6ZShjb20ud20udXRpbC5jb2Rlci5WYWx1
ZXNDb2RhYmxlW10gaW5wdXQsIGJvb2xlYW4gcmVjdXJzZSkgewogIGlmIChpbnB1dCA9PSBudWxs
KSByZXR1cm4gbnVsbDsKCiAgSURhdGFbXSBvdXRwdXQgPSBuZXcgSURhdGFbaW5wdXQubGVuZ3Ro
XTsKICBmb3IgKGludCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7CiAgICBvdXRwdXRb
aV0gPSBub3JtYWxpemUoaW5wdXRbaV0uZ2V0VmFsdWVzKCksIHJlY3Vyc2UpOwogIH0KICAKICBy
ZXR1cm4gb3V0cHV0Owp9CgoKLy8gcmVtb3ZlcyBhbGwga2V5cyBmcm9tIHRoZSBnaXZlbiBJRGF0
YSBkb2N1bWVudApwdWJsaWMgc3RhdGljIHZvaWQgY2xlYXIoSURhdGEgaW5wdXQpIHsKICBpZiAo
aW5wdXQgPT0gbnVsbCkgcmV0dXJuOwogIElEYXRhQ3Vyc29yIGN1cnNvciA9IGlucHV0LmdldEN1
cnNvcigpOwogIGN1cnNvci5maXJzdCgpOwogIHdoaWxlKGN1cnNvci5kZWxldGUoKSk7CiAgY3Vy
c29yLmRlc3Ryb3koKTsKfQoKLy8gcGVyZm9ybXMgdmFyaWFibGUgc3Vic3RpdHV0aW9uIG9uIGFs
bCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gSURhdGEgaW5wdXQgZG9jdW1lbnQKcHVibGljIHN0YXRp
YyBJRGF0YSBzdWJzdGl0dXRlKElEYXRhIGlucHV0LCBJRGF0YSBzY29wZSwgYm9vbGVhbiByZWN1
cnNlKSB7CiAgaWYgKGlucHV0ID09IG51bGwpIHJldHVybiBudWxsOwogIGlmIChzY29wZSA9PSBu
dWxsKSBzY29wZSA9IGlucHV0OwoKICBJRGF0YSBvdXRwdXQgPSBJRGF0YUZhY3RvcnkuY3JlYXRl
KCk7CgogIElEYXRhQ3Vyc29yIGljID0gaW5wdXQuZ2V0Q3Vyc29yKCk7CiAgSURhdGFDdXJzb3Ig
b2MgPSBvdXRwdXQuZ2V0Q3Vyc29yKCk7CgogIHRyeSB7CiAgICB3aGlsZShpYy5uZXh0KCkpIHsK
ICAgICAgU3RyaW5nIGtleSA9IGljLmdldEtleSgpOwogICAgICBPYmplY3QgdmFsdWUgPSBpYy5n
ZXRWYWx1ZSgpOwogICAgICBpZiAodmFsdWUgIT0gbnVsbCkgewogICAgICAgIGlmIChyZWN1cnNl
ICYmIHZhbHVlIGluc3RhbmNlb2YgSURhdGEpIHsKICAgICAgICAgIHZhbHVlID0gc3Vic3RpdHV0
ZSgoSURhdGEpdmFsdWUsIHNjb3BlLCByZWN1cnNlKTsKICAgICAgICB9IGVsc2UgaWYgKHJlY3Vy
c2UgJiYgKHZhbHVlIGluc3RhbmNlb2YgSURhdGFbXSB8fCB2YWx1ZSBpbnN0YW5jZW9mIGNvbS53
bS51dGlsLlRhYmxlKSkgewogICAgICAgICAgSURhdGFbXSBpYXJ5ID0gdmFsdWUgaW5zdGFuY2Vv
ZiBJRGF0YVtdID8gKElEYXRhW10pdmFsdWUgOiAoKGNvbS53bS51dGlsLlRhYmxlKXZhbHVlKS5n
ZXRWYWx1ZXMoKTsKICAgICAgICAgIElEYXRhW10gb2FyeSA9IG5ldyBJRGF0YVtpYXJ5Lmxlbmd0
aF07CiAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlhcnkubGVuZ3RoOyBpKyspIG9hcnlb
aV0gPSBzdWJzdGl0dXRlKGlhcnlbaV0sIHNjb3BlLCByZWN1cnNlKTsKICAgICAgICAgIHZhbHVl
ID0gb2FyeTsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAg
ICAgICAgICB2YWx1ZSA9IHR1bmRyYS5zdHJpbmcuc3Vic3RpdHV0ZSgoU3RyaW5nKXZhbHVlLCBz
Y29wZSk7CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZ1tdKSB7CiAg
ICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChTdHJpbmdbXSl2
YWx1ZSwgc2NvcGUpOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmdb
XVtdKSB7CiAgICAgICAgICB2YWx1ZSA9IHR1bmRyYS5saXN0LnN0cmluZy5zdWJzdGl0dXRlKChT
dHJpbmdbXVtdKXZhbHVlLCBzY29wZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIElEYXRhVXRp
bC5wdXQob2MsIGtleSwgdmFsdWUpOwogICAgfQogIH0gZmluYWxseSB7CiAgICBpYy5kZXN0cm95
KCk7CiAgICBvYy5kZXN0cm95KCk7CiAgfQoKICByZXR1cm4gb3V0cHV0Owp9</value>
  <value name="extends"></value>
  <array name="implements" type="value" depth="1">
  </array>
  <array name="imports" type="value" depth="1">
  </array>
</Values>
